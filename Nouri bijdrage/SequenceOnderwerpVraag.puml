@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Sequence.puml
title Booking Process - TripTop

actor reiziger


    Container(webApp, "Webapplicatie", "React.js", "Gebruikersinterface voor het plannen en beheren van reizen")

    Container_Boundary(cb, "Backend")
        Component(tripcontroller, "TripController", "Spring Boot Controller", "Ontvangt HTTP-verzoeken en verwerkt reisboekingen")
        Component(tripservice, "TripService", "Spring Boot Service", "Regelt de volledige afhandeling van boekingen en betalingen")
        Component(flightadapter, "VluchtAdapter", "Spring Boot Adapter", "Boekt vluchten bij externe providers")
        Component(trainadapter, "TreinAdapter", "Spring Boot Adapter", "Boekt treintickets via de NS API")
        Component(stayadapter, "OvernachtingAdapter", "Spring Boot Adapter", "Regelt accommodaties bij boekingsplatformen")
        Component(paymentadapter, "BetalingAdapter", "Spring Boot Adapter", "Verwerkt betalingen via betaalproviders")
        Component(triprepository, "TripRepository", "Spring Boot Repository", "Slaat boekingsgegevens op in de database")

Boundary_End()

System_Ext(ns, "NS API", "Ontvangt boekingsverzoeken voor treinen")
System_Ext(stay, "Accommodatie API (Booking.com, Airbnb)", "Ontvangt reserveringen voor accommodaties")
System_Ext(flight, "Vlucht API (Google Flights, Skyscanner)", "Ontvangt vluchtboekingen")
System_Ext(payment, "Betaalprovider (Stripe, Adyen, Mollie)", "Verwerkt betalingen")
ComponentDb(db, "Database", "Slaat reis- en betalingsgegevens op")

reiziger -> webApp: Boekt een reis
webApp -> tripcontroller: Stuurt boekingsverzoek
tripcontroller -> tripservice: Handelt boeking af
tripservice -> flightadapter: Boekt vlucht
flightadapter -> flight: Verstuurt vluchtboekingsverzoek
tripservice -> trainadapter: Boekt treinticket
trainadapter -> ns: Verstuurt treinkaartverzoek
tripservice -> stayadapter: Boekt accommodatie
stayadapter -> stay: Verstuurt reserveringsverzoek
tripservice -> paymentadapter: Verwerkt betaling
paymentadapter -> payment: Stuurt betalingsverzoek
tripservice -> triprepository: Slaat boekingsgegevens op
triprepository -> db: Beheert opslag in database
tripcontroller -> webApp: Bevestiging van de reis
webApp -> reiziger: Toont boekingsbevestiging

@enduml
